<?xml version='1.0'?>
<robot name="Edison" xmlns:xacro="http://ros.org/wiki/xacro">

	<material name="white">
		<color rgba="1 1 1 1"/>
	</material>
	<material name="black">
		<color rgba="0 0 0 1"/>
	</material>
	
   <link name="base_link" />
	<xacro:arg name="robotNamespace" default="/edison" />

   <!-- ********************** ROBOT BASE *********************************  -->
   <link name="base_footprint" >
	<visual>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<cylinder radius="0.125" length="0.11"/>
	  </geometry>
	  <material name="white"/>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<cylinder radius="0.125" length="0.11"/>
	  </geometry>
	  </collision>
	  <inertial>
		<mass value="3"/>
		<inertia ixx="0.0499" ixy="0.0" ixz="0.0" iyy="0.0499" iyz="0.0" izz="0.09375"/>
	  </inertial>
   </link>

   <!-- ********************** RIGHT WHEEL *********************************  -->
   <link name="right_wheel" >
	<visual>
	  <origin xyz="0 0 0" rpy="1.5707 -0 0"/>
	  <geometry>
		<cylinder radius="0.035" length="0.02"/>
	  </geometry>
	  <material name="black"/>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="1.5707 0 0"/>
	  <geometry>
		<cylinder radius="0.035" length="0.02"/>
	  </geometry>
	</collision>
	<inertial>
	  <mass value="0.5"/>
	  <inertia ixx="0.00080" ixy="0.0" ixz="0.0" iyy="0.00080" iyz="0.0" izz="0.000266"/>
	</inertial>
   </link>

   <!-- ********************** LEFT WHEEL *********************************  -->
   <link name="left_wheel" >
	<visual>
	  <origin xyz="0 0 0" rpy="1.5707 -0 0"/>
	  <geometry>
		<cylinder radius="0.035" length="0.02"/>
	  </geometry>
	  <material name="black"/>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="1.5707 0 0"/>
	  <geometry>
		<cylinder radius="0.035" length="0.02"/>
	  </geometry>
	</collision>
	<inertial>
	  <mass value="0.5"/>
	  <inertia ixx="0.00080" ixy="0.0" ixz="0.0" iyy="0.00080" iyz="0.0" izz="0.000266"/>
	</inertial>
   </link>  

   <!-- ********************** BALL 1 *********************************  -->
   <link name="ball_1" >
	<visual>
	  <origin xyz="0 0 0" rpy="1.5707 -0 0"/>
	  <geometry>
		<sphere radius="0.035"/>
	  </geometry>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<sphere radius="0.035"/>
	  </geometry>
	</collision>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
   </link>

   <!-- ********************** BALL 2 *********************************  -->
   <link name="ball_2" >
	<visual>
	  <origin xyz="0 0 0" rpy="1.5707 -0 0"/>
	  <geometry>
		<sphere radius="0.035"/>
	  </geometry>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<sphere radius="0.035"/>
	  </geometry>
	</collision>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
  </link>
   
   <!-- ********************** JOINTS *********************************  -->
  <joint name="joint_base_link" type="fixed">
   	<parent link="base_link"/>
   	<child link="base_footprint"/>
   	<origin xyz="0 0 0.07" rpy="0 0 0"/>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
  </joint>  
  <joint name="joint_wheel_left" type="continuous">
   	<parent link="base_footprint"/>
   	<child link="left_wheel"/>
   	<origin xyz="0 -0.115 -0.0425"/>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
  </joint>
  <joint name="joint_wheel_right" type="continuous">
  	<parent link="base_footprint"/>
  	<child link="right_wheel"/>
  	<origin xyz="0 0.115 -0.0425"/>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
  </joint>

  <joint name="joint_ball_1" type="fixed">
  	<parent link="base_footprint"/>
  	<child link="ball_1"/>
  	<origin xyz="-0.1 0 -0.0425" rpy="0 0 0"/>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
  </joint>
  
  <joint name="joint_ball_2" type="fixed">
  	<parent link="base_footprint"/>
  	<child link="ball_2"/>
  	<origin xyz="0.1 0 -0.0425" rpy="0 0 0"/>
	<inertial>
	  <mass value="0.2"/>
	  <inertia ixx="0.0000125" ixy="0.0" ixz="0.0" iyy="0.0000125" iyz="0.0" izz="0.0000125"/>
	</inertial>
  </joint>

<!-- ********************** MARVELMIND *********************************  -->
  <joint name="joint_marv" type="fixed">
   	<parent link="base_link"/>
   	<child link="marvelmind"/>
   	<origin xyz="-0.091 0 0.143" rpy="0 0 0"/>
  </joint>
     
  <link name='marvelmind'>
	<visual>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<box size='0.06 0.06 0.03'/>
	  </geometry>
	  <material name="black"/>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<box size='0.06 0.06 0.03'/>
	  </geometry>
	</collision>
	<inertial>
	  <mass value="0.1"/>
	  <inertia ixx="0.0001" ixy="0.0" ixz="0.0" iyy="0.0001" iyz="0.0" izz="0.00016"/>
	</inertial>
  </link>
<!-- ********************** IMU *********************************  -->
  <joint name="joint_imu" type="fixed">
   	<parent link="base_footprint"/>
   	<child link="imu"/>
   	<origin xyz="0.05 0.058 -0.04" rpy="0 0 0"/>
  </joint>

  <link name='imu'>
	<visual>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<box size='0.0038 0.0052 0.00113'/>
	  </geometry>
	  <material name="black"/>
	</visual>
	<collision>
	  <origin xyz="0 0 0" rpy="0 0 0"/>
	  <geometry>
		<box size='0.006 0.004 0.008'/>
	  </geometry>
	</collision>
	<inertial>
	  <mass value="0.01"/>
	  <inertia ixx="0.00001" ixy="0.0" ixz="0.0" iyy="0.00001" iyz="0.0" izz="0.000016"/>
	</inertial>
  </link>

  <joint name="lidar_joint" type="fixed">
    <parent link="base_link"/>
    <child link="lidar_link"/>
    <origin xyz="0.0 0 0.143" rpy="0 0 1.5708"/>
  </joint>

  <link name="lidar_link">
    <collision>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <cylinder radius="0.0508" length="0.18"/>
     </geometry>
    </collision>
    
    <visual>
     <origin xyz="0 0 0" rpy="0 0 0"/>
     <geometry>
      <cylinder radius="0.0508" length="0.18"/>
     </geometry>
     <material name="Black">
          <color rgba="${0/255} ${0/255} ${0/255} 1.0"/>
     </material>
    </visual>
    
    <inertial>
      <mass value="0.114" />
      <origin xyz="0 0 0" rpy="0 0 0"/>
      <inertia ixx="0.001" ixy="0" ixz="0" iyy="0.001" iyz="0" izz="0.001" />
    </inertial>
  </link>

<!-- ********************** TRANSMISSION *********************************  -->
  
    <transmission name="left_wheel_trans">
	<type>transmission_interface/SimpleTransmission</type>
	<actuator name="$left_wheel_motor">
	<mechanicalReduction>1</mechanicalReduction>
	</actuator>
	<joint name="left_wheel_joint">
	<hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
	</joint>
  </transmission>
  

  <transmission name="right_wheel_trans">
	<type>transmission_interface/SimpleTransmission</type>
	<actuator name="$right_wheel_motor">
	<mechanicalReduction>1</mechanicalReduction>
	</actuator>
	<joint name="right_wheel_joint">
	<hardwareInterface>hardware_interface/VelocityJointInterface</hardwareInterface>
	</joint>
  </transmission>

  <!-- ********************** GAZEBO *********************************  -->
	<gazebo reference="right_wheel">
		<material>Gazebo/Black</material>
		<mu1 value="200.0"/>
		<mu2 value="100.0"/>
		<kp value="10000000.0" />
		<kd value="1.0" />
		<fdir1 value="1 0 0"/>
	</gazebo>
	<gazebo reference="left_wheel">
		<material>Gazebo/Black</material>
		<mu1 value="200.0"/>
	  	<mu2 value="100.0"/>
	  	<kp value="10000000.0" />
	  	<kd value="1.0" />
	  	<fdir1 value="1 0 0"/>
	</gazebo>
	<gazebo reference="base_link">
		<material>Gazebo/White</material>
	</gazebo>
	
  	 

	<!-- Diff drive -->
	<gazebo>
		<plugin name="gazebo_ros_diff_drive" filename="libgazebo_ros_diff_drive.so">
			<alwaysOn>true</alwaysOn>
			<updateRate>10</updateRate>
			<max_wheel_torque>100</max_wheel_torque>
			<left_joint>joint_wheel_left</left_joint>
			<right_joint>joint_wheel_right</right_joint>
			<wheel_separation>0.0955</wheel_separation>
			<wheel_diameter>0.044</wheel_diameter>
            <command_topic>cmd_vel</command_topic>
            <publish_odom>true</publish_odom>
            <publish_odom_tf>true</publish_odom_tf>
            <odometry_topic>odom</odometry_topic>
            <odometry_frame>odom</odometry_frame>
			<robot_base_frame>base_link</robot_base_frame>
			<ros>
                <namespace>$(arg robotNamespace)</namespace>
            </ros>
		</plugin>
	</gazebo>
		
		

</robot>
